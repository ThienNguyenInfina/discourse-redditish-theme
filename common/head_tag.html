<script type="text/discourse-plugin" version="0.8">
  api.onPageChange((url, title) => {
    const user = api.getCurrentUser();

    if(user){
        return;
    };

    const observer = new MutationObserver((mutationsList, observer) => {
      for(let mutation of mutationsList) {
        if (mutation.type === 'childList') {
          modifyLoginButton();
          hideToggleOutlet();
        }
      }
    });

    const header = document.querySelector('.d-header');  // Replace with the appropriate selector
    if(header) {
      observer.observe(header, { attributes: false, childList: true, subtree: true });
    }

    function hideToggleOutlet() {
      if(!user || !user.admin){
        const outletButton = document.querySelector("#toggle-plugin-outlets");
        if (outletButton) {
          outletButton.style.display = "none";
        }
      }
    }

    function modifyLoginButton() {
      const loginButton = document.querySelector(".login-button");
      const spanLabel = loginButton.querySelector(".d-button-label");

      if (spanLabel) {
        spanLabel.textContent = "Tải ứng dụng";
      }

      loginButton.addEventListener('click', function(event) {
        event.preventDefault();
        event.stopPropagation();
        window.open("https://onelink.to/seohomepageinfina", '_blank');
      }, true);
    }

    modifyLoginButton();
  });
</script>

<script type="text/discourse-plugin" version="0.8">
  api.onPageChange((url, title) => {
    if(url.includes("/t/")) {
      // Select the element with class "cooked"
      const cookedElement = document.querySelector(".cooked");

      if (cookedElement) {
          // Use a regular expression to replace the undesired part
          cookedElement.innerHTML = cookedElement.innerHTML.replace(/\s*\[question\] [^<]+/, '');
      }
    }
  });
</script>
