<script type="text/discourse-plugin" version="0.8">
  api.onPageChange((url, title) => {
    const user = api.getCurrentUser();

    // If user is not logged in
    if (!user) {
        const replyButton = document.querySelector("#topic-footer-buttons .btn-icon-text");
        const likeButton = document.querySelector(".actions .double-button .toggle-like");

        const showModal = require("discourse/lib/show-modal").default;

        if(replyButton) {
            replyButton.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
                console.log("click reply");
                showModal("downloadAppModal");
            }, true);
        }

        if(likeButton) {
            likeButton.addEventListener('click', function(event) {
                event.preventDefault();
                event.stopPropagation();
                console.log("click heart");
                showModal("downloadAppModal");
            }, true);
        }
    }
  });
</script>

<script type="text/discourse-plugin" version="0.8">
  api.onPageChange((url, title) => {
    const user = api.getCurrentUser();

    if(user){
        return;
    };

    const observer = new MutationObserver((mutationsList, observer) => {
      for(let mutation of mutationsList) {
        if (mutation.type === 'childList') {
          modifyLoginButton();
          hideToggleOutlet();
        }
      }
    });

    const header = document.querySelector('.d-header');  // Replace with the appropriate selector
    if(header) {
      observer.observe(header, { attributes: false, childList: true, subtree: true });
    }

    function hideToggleOutlet() {
      if(!user || !user.admin){
        const outletButton = document.querySelector("#toggle-plugin-outlets");
        if (outletButton) {
          outletButton.style.display = "none";
        }
      }
    }

    function modifyLoginButton() {
      const loginButton = document.querySelector(".login-button");
      const spanLabel = loginButton.querySelector(".d-button-label");

      if (spanLabel) {
        spanLabel.textContent = "Tải ứng dụng";
      }

      loginButton.addEventListener('click', function(event) {
        event.preventDefault();
        event.stopPropagation();
        window.location.href = "https://onelink.to/seohomepageinfina";
      }, true);
    }

    modifyLoginButton();
  });
</script>
